<% breadcrumb :cart %>


  Shopping Cart

  <% if @cart_items.empty? %>
    Your cart is empty.
    <%= link_to "Continue Shopping", products_path, class: "btn btn-primary" %>
  <% else %>

      <% @cart_items.each do |product, quantity| %>


            <% if product.main_image.attached? %>
              <%= image_tag product.main_image.variant(:thumb), alt: product.name %>
            <% end %>



            <%= link_to product.name, product_path(product) %>
            <%= product.brand %>
            $<%= number_with_precision(product.price, precision: 2) %>



            <%= form_with url: cart_item_path(product.id), method: :patch, local: true do %>
              <%= number_field_tag :quantity, quantity, min: 1, class: "quantity-input" %>
              <%= submit_tag "Update", class: "btn btn-small" %>
            <% end %>



            $<%= number_with_precision(product.price * quantity, precision: 2) %>



            <%= button_to "Remove", cart_item_path(product.id), method: :delete, class: "btn btn-danger btn-small", data: { confirm: "Are you sure?" } %>


      <% end %>



      Cart Total: $<%= number_with_precision(@total, precision: 2) %>
      <%= link_to "Proceed to Checkout", new_order_path, class: "btn btn-primary btn-large" %>
      <%= link_to "Continue Shopping", products_path, class: "btn btn-secondary" %>

  <% end %>